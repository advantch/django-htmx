{% load humanize %}
{% for home in homes %}
    <li class="relative">
        <!--like button-->
        <svg xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 absolute top-2 right-2 cursor-pointer fill-gray-600 stroke-white" viewBox="0 0 20 20"
            fill="currentColor">
            <path fill-rule="evenodd"
                d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z"
                clip-rule="evenodd"/>
        </svg>

        <!--Image-->
        <div class="focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-offset-gray-100 focus-within:ring-indigo-500 group block w-full aspect-w-10 aspect-h-7 rounded-lg bg-gray-100 overflow-hidden">
            <div class="h-48 w-full">
                <img src="{{ home.image_url }}" alt="" class="object-cover pointer-events-none group-hover:opacity-75">
            </div>
            <button type="button"
                hx-get="{% url "mybnb:preview" home.id %}"
                hx-target="body"
                hx-swap="beforeend"
                class="absolute inset-0 focus:outline-none z-30" >
                <span class="sr-only">{{ home.address }}</span>
            </button>
        </div>
        <!--Details-->
        <div class="flex justify-between">
            <div class="flex flex-col">
                <p class="mt-2 block text-sm font-medium text-gray-900 truncate pointer-events-none">{{ home.city }}</p>
                <p class="block text-sm font-medium text-gray-500 pointer-events-none">{{ home.country }}</p>
            </div>
            <div class="flex flex-col">
                <p class="mt-2 block text-xs font-semibold text-gray-700 underline truncate pointer-events-none">
                    ${{ home.price|floatformat:"0"|intcomma }} total
                </p>
            </div>
        </div>
        {# infinite scroll only if 20 or more items in search query #}
        {% if forloop.last and total > 19 %}
            <div
                _="on intersection(intersecting)
                    if intersecting call infiniteScroll()">
            </div>
        {% endif %}
    </li>
{% endfor %}

{# oob response to show search stats under the search button #}
{% if request.htmx %}
    {% include "mybnb/htmx/stats.html" %}
    {% include "mybnb/components/offset.html" %}
{% endif %}
